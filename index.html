<!DOCTYPE html>
<html lang="fa-IR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- CSS file link -->
    <link rel="stylesheet" href="/assets/styles/font.css">
    <link rel="stylesheet" href="/assets/styles/style.css">

    <!-- icons -->
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <title>Document</title>

</head>


<body>
    <container>
        <icon-wrapper class="flex">
            <i><img src="/assets/images/icons/user.svg" class="user-icon"></i>
            <i><img src="/assets/images/icons/setting.svg" class="setting-icon"></i>
        </icon-wrapper>
        <wrapper class="flex">
            <right-side>
                <h2>
                    دستنویس
                </h2>
                <hr>
                <todo-list>
                    <ul class="todo-list-ul">

                    </ul>
                </todo-list>
                <hr>
                <insert-todo-box class="flex">
                    <input class="todo-input-box" type="text" placeholder="نوشتن تسک جدید">
                    <button class="plus-button"><i class='bx bx-plus-medical'
                            style='color:rgba(0,0,0,0.29)'></i></button>
                </insert-todo-box>
            </right-side>


            <main>

            </main>
            <left-side>

            </left-side>

        </wrapper>

    </container>
    <script>
        const addBtn = document.querySelector(".plus-button");
        const inputBox = document.querySelector(".todo-input-box");
        const firstTask = document.querySelector(".first-task");
        const todoList = document.querySelector(".todo-list-ul");


        showTasks();
        addBtn.addEventListener("click", () => {
            const userEnterTodo = inputBox.value.trim();
            const getLocalstorageData = JSON.parse(localStorage.getItem("todo")) || [];
            getLocalstorageData.push(userEnterTodo);

            if (!userEnterTodo) {
                alert("لطفا مطبی را وارد کنید")
            } else {
                localStorage.setItem("todo", JSON.stringify(getLocalstorageData));
            }

            showTasks();
            inputBox.value = "";
        });


        function deleteItem(index) {
            const getLocalstorageData = JSON.parse(localStorage.getItem("todo")) || []
            const updatedItem = getLocalstorageData.filter((_, i) => i !== index);
            localStorage.setItem("todo", JSON.stringify(updatedItem));
            showTasks();

        }

        function showTasks() {
            let newTag = "";

            let getLocalstorageData = localStorage.getItem("todo");
            if (!getLocalstorageData) {
                listArray = ["کار شماره اول من"];
            } else {
                listArray = JSON.parse(getLocalstorageData);
            }


            listArray.forEach((element, index) => {
                newTag += `<li>
                            <div class="flex">
                                <button class="edit-button"><i class='bx bxs-square' style='color:#27ed2c'></i></button>
                                <p>${element}</p>
                            </div>
                            <button class="delete-button"><i class='bx bxs-trash' style='color:#df1226' onclick="deleteItem(${index})"></i></button>
                        </li>`;
            });
            todoList.innerHTML = newTag;


        }
    </script>
</body>

</html>